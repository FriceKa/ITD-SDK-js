# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å—Ç–æ–≤ –ø–æ–¥—Ä—è–¥ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏, –∏ SDK –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –µ–≥–æ –±–µ–∑ refresh_token –≤ cookies.

## –†–µ—à–µ–Ω–∏–µ

–í –≤–µ—Ä—Å–∏–∏ **1.0.4** –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏:

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è refresh_token

```javascript
if (client.hasRefreshToken()) {
    console.log('‚úÖ Refresh token –¥–æ—Å—Ç—É–ø–µ–Ω');
} else {
    console.log('‚ö†Ô∏è  Refresh token –Ω–µ –Ω–∞–π–¥–µ–Ω - –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª .cookies');
}
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
const isValid = await client.validateAndRefreshToken();
if (isValid) {
    // –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω
    const post = await client.createPost('–¢–µ–∫—Å—Ç', 'image.jpg');
} else {
    // –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å
    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω');
}
```

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```javascript
class HoroscopeScheduler {
  constructor() {
    this.client = new ITDClient();
    this.client.setAccessToken(process.env.ITD_ACCESS_TOKEN);
    this.client.auth.isAuthenticated = true;
  }
  
  async postHoroscope(zodiacSign) {
    // –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º
    const tokenValid = await this.client.validateAndRefreshToken();
    
    if (!tokenValid) {
      console.error('–¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å');
      return null;
    }
    
    // –ü—É–±–ª–∏–∫—É–µ–º –ø–æ—Å—Ç
    return await publishHoroscope(this.client, zodiacSign, this.tempDir);
  }
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```javascript
class HoroscopeScheduler {
  constructor() {
    this.client = new ITDClient();
    this.client.setAccessToken(process.env.ITD_ACCESS_TOKEN);
    this.client.auth.isAuthenticated = true;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ refresh_token
    if (!this.client.hasRefreshToken()) {
      console.warn('‚ö†Ô∏è  Refresh token –Ω–µ –Ω–∞–π–¥–µ–Ω - —Ç–æ–∫–µ–Ω –Ω–µ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏');
      console.warn('üí° –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª .cookies –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞');
    }
  }
  
  async postHoroscope(zodiacSign) {
    // SDK –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ
    // –ù–æ —ç—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å refresh_token
    return await publishHoroscope(this.client, zodiacSign, this.tempDir);
  }
}
```

## –í–∞–∂–Ω–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .cookies —Ñ–∞–π–ª–∞

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º —Ñ–∞–π–ª `.cookies` —Å refresh_token:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∏—Ç–¥.com –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí –≤–∫–ª–∞–¥–∫–∞ Network
3. –ù–∞–π–¥–∏—Ç–µ –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å –∫ –∏—Ç–¥.com (–Ω–∞–ø—Ä–∏–º–µ—Ä, GET /api/users/me)
4. –û—Ç–∫—Ä–æ–π—Ç–µ Headers ‚Üí Request Headers
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Cookie`
6. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.cookies` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
7. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Cookie –µ—Å—Ç—å `refresh_token`

**–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ .cookies:**
```
refresh_token=eyJhbGci...; __ddg1_=...; __ddg2_=...; is_auth=1
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–º. —Ñ–∞–π–ª `examples/token-validation.js` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–∏ 1.0.4

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `hasRefreshToken()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è refresh_token
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `validateAndRefreshToken()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ refresh_token
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä `examples/token-validation.js`
